<section id="facilities">

 <header class="editable-header-type-h2 flex gap-3 items-baseline">
    <h2><%= Facility.model_name.human(count: 2) %></h2>
    <%= button_to_modal :new_facility_review_path,
                        "aria-label": "Rediger fasiliteter",
                        class: 'unstyled-link edit-button collapsable' do %>
      <span class="text">
          Rediger
        </span>
      <%= inline_svg_tag 'edit', alt: 'RedigÃ©r', title: 'RedigÃ©r' %>
    <% end %>
  </header>

  <% if @grouped_relevant_facilities.present? %>
    <main class="grid divide-y">
      <% @grouped_relevant_facilities.each do | group |  %>
        <%= render 'spaces/show/facility_group', group: %>
      <% end %>
    </main>
  <% end %>

  <% if @grouped_non_relevant_facilities.present?  %>
    <p class="text-gray-500">
      <%= t('facility_reviews.new.showing_relevant_facilities',
            space_title:  @space.title,
            space_types: @space.space_types.map{ |type| type.type_name }.to_sentence) %>
    </p>
    <details class="mb-8 group">
      <summary class="link">
        <span>Vis <%= @non_relevant_facilities.count %> andre fasiliteter</span>
      </summary>
      <% @grouped_non_relevant_facilities.each do |group| %>
        <%= render 'spaces/show/facility_group', group: %>
    <% end %>
    </details>
  <% end %>

  <aside>
    <%= modal_for :new_facility_review_path, "h-90vh modal--with-header-and-footer" do  %>
      <% turbo_frame_tag :new_facility_review_path, target: "_top", src: new_facility_review_path(@space), loading: "lazy" do %>
        <%= render "shared/loading" %>
      <% end %>
    <% end  %>
  </aside>

</section>
